{% extends "dashboard/base_authenticated.html" %}

{% block page_title %}Sensor Data - CropMate{% endblock %}
{% block sidebar_sensors %}active{% endblock %}

{% block extra_css %}
<style>
.sensor-card {
    border-radius: 15px;
    animation: fadeInUp 0.6s ease-out;
}

.progress-bar {
    background: linear-gradient(90deg, #10b981, #059669);
    border-radius: 6px;
}

.live-indicator {
    display: inline-flex;
    align-items: center;
    background: linear-gradient(135deg, #10b981, #059669);
    color: white;
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: 600;
}

.live-dot {
    width: 6px;
    height: 6px;
    background: white;
    border-radius: 50%;
    margin-right: 6px;
}
</style>
{% endblock %}

{% block header_title %}Sensor Data Monitoring{% endblock %}

{% block header_extra %}
<div class="live-indicator">
    <div class="live-dot"></div>
    <span>LIVE</span>
</div>
{% endblock %}

{% block content %}
<div class="mb-8">
    <div class="mb-6">
        <h3 class="text-2xl font-bold text-gray-800">Live Sensors Data</h3>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
        <div class="sensor-card bg-white p-4 rounded-lg shadow-md border-l-4 border-blue-500">
            <div class="mb-3">
                <h4 class="text-sm font-semibold text-gray-800">Nitrogen (N)</h4>
                <span class="px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-medium">Good</span>
            </div>
            <div class="text-center">
                <div class="sensor-value text-2xl font-bold text-blue-600 mb-2" id="nitrogenValue">45</div>
                <div class="text-gray-500 text-sm mb-2">ppm</div>
                <div class="w-full bg-gray-200 rounded-full h-2">
                    <div class="progress-bar h-2 rounded-full" style="width: 75%; background: linear-gradient(90deg, #3b82f6, #2563eb);"></div>
                </div>
            </div>
        </div>

        <div class="sensor-card bg-white p-4 rounded-lg shadow-md border-l-4 border-purple-500">
            <div class="mb-3">
                <h4 class="text-sm font-semibold text-gray-800">Phosphorus (P)</h4>
                <span class="px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs font-medium">Fair</span>
            </div>
            <div class="text-center">
                <div class="sensor-value text-2xl font-bold text-purple-600 mb-2" id="phosphorusValue">28</div>
                <div class="text-gray-500 text-sm mb-2">ppm</div>
                <div class="w-full bg-gray-200 rounded-full h-2">
                    <div class="progress-bar h-2 rounded-full" style="width: 56%; background: linear-gradient(90deg, #8b5cf6, #7c3aed);"></div>
                </div>
            </div>
        </div>

        <div class="sensor-card bg-white p-4 rounded-lg shadow-md border-l-4 border-green-500">
            <div class="mb-3">
                <h4 class="text-sm font-semibold text-gray-800">Potassium (K)</h4>
                <span class="px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs font-medium">Excellent</span>
            </div>
            <div class="text-center">
                <div class="sensor-value text-2xl font-bold text-green-600 mb-2" id="potassiumValue">67</div>
                <div class="text-gray-500 text-sm mb-2">ppm</div>
                <div class="w-full bg-gray-200 rounded-full h-2">
                    <div class="progress-bar h-2 rounded-full" style="width: 89%; background: linear-gradient(90deg, #10b981, #059669);"></div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="mb-8">


    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
        <div class="sensor-card bg-white p-4 rounded-lg shadow-md">
            <div class="mb-3">
                <h4 class="text-sm font-semibold text-gray-800">Temperature</h4>
                <span class="px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs font-medium">Optimal</span>
            </div>
            <div class="text-center">
                <div class="sensor-value text-2xl font-bold text-orange-600" id="temperatureValue">28.5°C</div>
            </div>
        </div>

        <div class="sensor-card bg-white p-4 rounded-lg shadow-md">
            <div class="mb-3">
                <h4 class="text-sm font-semibold text-gray-800">Humidity</h4>
                <span class="px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs font-medium">Good</span>
            </div>
            <div class="text-center">
                <div class="sensor-value text-2xl font-bold text-cyan-600 mb-2" id="humidityValue">65%</div>
                <div class="w-full bg-gray-200 rounded-full h-2">
                    <div class="progress-bar h-2 rounded-full" style="width: 65%; background: linear-gradient(90deg, #06b6d4, #0891b2);"></div>
                </div>
            </div>
        </div>

        <div class="sensor-card bg-white p-4 rounded-lg shadow-md">
            <div class="mb-3">
                <h4 class="text-sm font-semibold text-gray-800">Soil Moisture</h4>
                <span class="px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs font-medium">Low</span>
            </div>
            <div class="text-center">
                <div class="sensor-value text-2xl font-bold text-amber-600 mb-2" id="soilMoistureValue">42%</div>
                <div class="w-full bg-gray-200 rounded-full h-2">
                    <div class="progress-bar h-2 rounded-full" style="width: 42%; background: linear-gradient(90deg, #d97706, #b45309);"></div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
const sensorData = {
    nitrogen: 45,
    phosphorus: 28,
    potassium: 67,
    temperature: 28.5,
    humidity: 65,
    soilMoisture: 42
};

function startDataUpdates() {
    setInterval(() => {
        sensorData.nitrogen += (Math.random() - 0.5) * 2;
        sensorData.phosphorus += (Math.random() - 0.5) * 1.5;
        sensorData.potassium += (Math.random() - 0.5) * 3;
        sensorData.temperature += (Math.random() - 0.5) * 0.5;
        sensorData.humidity += (Math.random() - 0.5) * 2;
        sensorData.soilMoisture += (Math.random() - 0.5) * 1;

        sensorData.nitrogen = Math.max(30, Math.min(60, sensorData.nitrogen));
        sensorData.phosphorus = Math.max(20, Math.min(40, sensorData.phosphorus));
        sensorData.potassium = Math.max(50, Math.min(80, sensorData.potassium));
        sensorData.temperature = Math.max(20, Math.min(35, sensorData.temperature));
        sensorData.humidity = Math.max(40, Math.min(85, sensorData.humidity));
        sensorData.soilMoisture = Math.max(25, Math.min(65, sensorData.soilMoisture));

        document.getElementById('nitrogenValue').textContent = Math.round(sensorData.nitrogen);
        document.getElementById('phosphorusValue').textContent = Math.round(sensorData.phosphorus);
        document.getElementById('potassiumValue').textContent = Math.round(sensorData.potassium);
        document.getElementById('temperatureValue').textContent = sensorData.temperature.toFixed(1) + '°C';
        document.getElementById('humidityValue').textContent = Math.round(sensorData.humidity) + '%';
        document.getElementById('soilMoistureValue').textContent = Math.round(sensorData.soilMoisture) + '%';
    }, 5000);
}

document.addEventListener('DOMContentLoaded', startDataUpdates);
</script>
{% endblock %}
